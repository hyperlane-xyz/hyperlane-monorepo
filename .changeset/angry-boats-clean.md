---
'@hyperlane-xyz/sdk': patch
---

Gnosis Safe utilities were expanded and centralized in the SDK, including Safe service initialization, signer resolution, retry helpers, transaction proposal and execution helpers, pending transaction queries, Safe owner update helpers, multisend decoding helpers, Safe deployment transaction building, and known multisend deployment address discovery.

Infra scripts were refactored to consume the SDK Safe utilities directly, duplicated infra Safe utility code was removed, and direct `@safe-global/*` infra dependencies used only for Safe utilities were dropped in favor of SDK helpers.

Safe utility typing and robustness were improved by modeling nullable tx-service fields, hardening Safe API version parsing for real-world semver formats (including uppercase `V` prefixes, strict separator rules that reject malformed patch suffix concatenation like `5.18.0foo`, semver identifier validation that rejects empty dot segments/empty suffixes/invalid metadata characters, leading-zero numeric core components and leading-zero numeric prerelease identifiers, safe-integer guards on semver components, and support for valid combined prerelease+build forms like `-rc.1+build.7`), tightening Safe tx payload validation and owner-diff invariants with duplicate-owner and invalid-address fail-fast checks, normalizing Safe service URLs (including host-only URL handling via inferred `https://`, protocol/hostname URL parse guards with non-http(s) scheme rejection, malformed explicit http(s)—including malformed slash/backslash delimiter forms like `https:/...` and `https:\\...`—raw backslash URL rejection, slash-prefixed and triple-slash relative paths, invalid scheme-relative host:port values—including empty-port variants—malformed scheme-relative authority prefixes/userinfo (`//@`, `//:`, `//user@...`), host-only/scheme-relative userinfo-like authority rejection (`@`, `%40`, and repeated `%25`-encoded `%40` spoof variants), explicit URL userinfo rejection (including extra-slash explicit authorities like `http:///safe.global@evil.com/api`), percent-encoded authority host-octet rejection (for explicit, scheme-relative, and host-only inputs), non-ASCII and control/whitespace authority rejection (including unicode-dot host confusables and embedded tab/newline/carriage-return authorities), extra-slash explicit http(s) parsing, protocol default-port canonicalization with path preservation, invalid colon-delimited URL fail-fast behavior, generic non-http colon-scheme classification, case-insensitive `/api` canonicalization, whitespace trimming, query/hash stripping, and empty-value fail-fast assertions), tightening Safe API key host matching (including host-only inputs, host-with-port parsing, trailing-dot FQDN normalization, subdomain-boundary checks, slash-prefixed and triple-slash relative path rejection, invalid scheme-relative host:port rejection—including empty-port variants—malformed scheme-relative authority prefix/userinfo rejection, explicit URL userinfo rejection, malformed slash/backslash explicit http(s) delimiter rejection, raw backslash URL rejection, non-http(s) scheme rejection—including non-authority schemes like `mailto:`, userinfo-like authority spoof rejection (`@`, `%40`, and repeated `%25`-encoded `%40`), percent-encoded authority host-octet rejection, non-ASCII and control/whitespace authority rejection, encoded-backslash authority spoof rejection for both literal `@` and `%40` forms, and preserving valid `@`, `%40`, `%2540`, `%5C`, and repeated `%25`-encoded backslash characters in path/query/fragment data), hardening multisend decoding with strict segment-boundary checks that reject truncated payload headers/bodies, overflowed data-length fields, and unsupported operation values, adding deployment transaction fail-fast assertions, and requiring typed-data signer support before Safe tx deletion.
