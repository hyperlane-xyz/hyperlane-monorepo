rpc_endpoint_b3 := "https://sepolia.b3.fun/http"
rpc_endpoint_ape := "https://curtis.rpc.caldera.xyz/http"
rpc_endpoint_everclear_staging := "https://rpc.everclear.raas.gelato.cloud"
rpc_endpoint_base := "https://mainnet.base.org"
chain_id_b3 := "1993"
chain_id_ape := "33111"
chain_id_everclear_staging := "25327"
chain_id_base := "8453"
polymer_prover_addr := "0xcDa03d74DEc5B24071D1799899B2e0653C24e5Fa"
polymer_prover_addr_mainnet := "0x441f16587d8a8cACE647352B24E1Aefa55ACEA76"
mailbox_contract_addr_b3 := "0x840e5aada7a7aab5f06c5d3152512a246792183f"
mailbox_contract_addr_ape := "0xd3dd44aadd6c790322c3a8da37d6b9a6d72f5c28"
mailbox_contract_addr_everclear_staging := "0xd84ab43d7f2f99339657e4bfae3c955be8d3099c"
mailbox_contract_addr_base := "0xd84ab43d7f2f99339657e4bfae3c955be8d3099c"
polymer_ism_addr_b3 := "0x5615c90c3142ebbb5bba6dde1616251581d1f16c"
polymer_ism_addr_ape := "0x5dfe4bb5aa44e459980ac1804aea4593af088cb9"
polymer_ism_addr_everclear_staging := "0x593ca6a919b9946aa8a9abfd7c499f3fee8d7a9e"
polymer_ism_addr_base := "0x568638bde8a0d48f291d516fcf05d70f019ebb7e"
default_fallback_routing_ism_addr_b3 := "0x201d9d1da9a31dd8966f54e3466f615b72e53c46"
default_fallback_routing_ism_addr_ape := "0xb9579911530c36165c9e3f09ed02af47763b4fbc"
default_fallback_routing_ism_addr_everclear_staging := "0xdb1dcc0d1cfc8a887fc04049fcf528b8e3b78cff"
default_fallback_routing_ism_addr_base := "0x9946b5c0efb676c8fc9d928877d9eb578b73ec15"
default_mailbox_contract_addr_everclear_staging := "0x7f50C5776722630a0024fAE05fDe8b47571D7B39"
default_mailbox_contract_addr_base := "0xeA87ae93Fa0019a82A727bfd3eBd1cFCa8f64f1D"
domain_routing_mailbox_addr_everclear_staging := "0x46cb3da13fd222887ef869e2db5ab73c854fcf0d"
domain_routing_mailbox_addr_base := "0x46cb3da13fd222887ef869e2db5ab73c854fcf0d"
domain_routing_hook_addr_everclear_staging := "0x25e08Cab980ecA621dEc42aC781705DA107458B5"
fallback_domain_receipt_routing_hook_addr_everclear_staging := "0xF1C252dE5c21A19A1660C8a4B58A69f5F9c0c6f0"
protocol_fee_hook_addr_everclear_staging := "0xC49aF4965264FA7BB6424CE37aA06773ad177224"
mock_hook_addr_everclear_staging := "0x840E5AaDa7A7aaB5F06C5D3152512A246792183F"
fallback_domain_routing_hook_addr_everclear_staging := "0x2198bF096FC8C3C05C4B5a53ACe8D9dA3E94ef95"
simple_sender_receiver_addr_b3 := "0xf689811ed7fed46ae6ca9251d62d9d1cc528ba5a"
simple_sender_receiver_addr_ape := "0x840e5aada7a7aab5f06c5d3152512a246792183f"
simple_sender_receiver_addr_everclear_staging := "0x56088923b84121327b85802Dcca1A84478eB1ea2"
simple_sender_receiver_addr_base := "0xc81686396C44dD0f39A76de2BeC5CCE2eE3d4548"

deploy-mailbox-b3:
    export HYPERLANE_DOMAIN_ID="{{ chain_id_b3 }}" && \
    forge script script/DeployMailbox.s.sol:DeployMailbox \
        --rpc-url "{{ rpc_endpoint_b3 }}" \
        --broadcast \
        -vvvv

deploy-mailbox-ape:
    export HYPERLANE_DOMAIN_ID="{{ chain_id_ape }}" && \
    forge script script/DeployMailbox.s.sol:DeployMailbox \
        --rpc-url "{{ rpc_endpoint_ape }}" \
        --broadcast \
        -vvvv

deploy-mailbox-base:
    export HYPERLANE_DOMAIN_ID="{{ chain_id_base }}" && \
    forge script script/DeployMailbox.s.sol:DeployMailbox \
        --rpc-url "{{ rpc_endpoint_base }}" \
        --broadcast \
        -vvvv

deploy-mailbox-everclear-staging:
    export HYPERLANE_DOMAIN_ID="{{ chain_id_everclear_staging }}" && \
    forge script script/DeployMailbox.s.sol:DeployMailbox \
        --rpc-url "{{ rpc_endpoint_everclear_staging }}" \
        --broadcast \
        -vvvv

deploy-polymer-ism-b3:
    export ORIGIN_MAILBOX_ADDRESS="{{ mailbox_contract_addr_ape }}" && \
    export POLYMER_PROVER_ADDRESS="{{ polymer_prover_addr }}" && \
    forge script script/DeployPolymerIsm.s.sol:DeployPolymerIsm \
        --rpc-url "{{ rpc_endpoint_b3 }}" \
        --broadcast \
        -vvvv

deploy-polymer-ism-ape:
    export ORIGIN_MAILBOX_ADDRESS="{{ mailbox_contract_addr_b3 }}" && \
    export POLYMER_PROVER_ADDRESS="{{ polymer_prover_addr }}" && \
    forge script script/DeployPolymerIsm.s.sol:DeployPolymerIsm \
        --rpc-url "{{ rpc_endpoint_ape }}" \
        --broadcast \
        -vvvv

deploy-polymer-ism-base:
    export ORIGIN_MAILBOX_ADDRESS="{{ mailbox_contract_addr_everclear_staging }}" && \
    export POLYMER_PROVER_ADDRESS="{{ polymer_prover_addr_mainnet }}" && \
    forge script script/DeployPolymerIsm.s.sol:DeployPolymerIsm \
        --rpc-url "{{ rpc_endpoint_base }}" \
        --broadcast \
        -vvvv

deploy-polymer-ism-everclear-staging:
    export ORIGIN_MAILBOX_ADDRESS="{{ mailbox_contract_addr_base }}" && \
    export POLYMER_PROVER_ADDRESS="{{ polymer_prover_addr_mainnet }}" && \
    forge script script/DeployPolymerIsm.s.sol:DeployPolymerIsm \
        --rpc-url "{{ rpc_endpoint_everclear_staging }}" \
        --broadcast \
        -vvvv

deploy-default-fallback-routing-ism-b3:
    export LOCAL_MAILBOX_ADDRESS="{{ mailbox_contract_addr_b3 }}" && \
    export REMOTE_ORIGIN_DOMAIN_ID="{{ chain_id_ape }}" && \
    export POLYMER_ISM_FOR_REMOTE_ORIGIN_ADDRESS="{{ polymer_ism_addr_b3 }}" && \
    forge script script/DeployDefaultFallbackRoutingIsm.s.sol:DeployDefaultFallbackRoutingIsm \
        --rpc-url "{{ rpc_endpoint_b3 }}" \
        --broadcast \
        -vvvv

deploy-default-fallback-routing-ism-ape:
    export LOCAL_MAILBOX_ADDRESS="{{ mailbox_contract_addr_ape }}" && \
    export REMOTE_ORIGIN_DOMAIN_ID="{{ chain_id_b3 }}" && \
    export POLYMER_ISM_FOR_REMOTE_ORIGIN_ADDRESS="{{ polymer_ism_addr_ape }}" && \
    forge script script/DeployDefaultFallbackRoutingIsm.s.sol:DeployDefaultFallbackRoutingIsm \
        --rpc-url "{{ rpc_endpoint_ape }}" \
        --broadcast \
        -vvvv

deploy-default-fallback-routing-ism-everclear-staging:
    export LOCAL_MAILBOX_ADDRESS="{{ mailbox_contract_addr_everclear_staging }}" && \
    export REMOTE_ORIGIN_DOMAIN_ID="{{ chain_id_base }}" && \
    export POLYMER_ISM_FOR_REMOTE_ORIGIN_ADDRESS="{{ polymer_ism_addr_everclear_staging }}" && \
    forge script script/DeployDefaultFallbackRoutingIsm.s.sol:DeployDefaultFallbackRoutingIsm \
        --rpc-url "{{ rpc_endpoint_everclear_staging }}" \
        --broadcast \
        -vvvv

deploy-default-fallback-routing-ism-base:
    export LOCAL_MAILBOX_ADDRESS="{{ mailbox_contract_addr_base }}" && \
    export REMOTE_ORIGIN_DOMAIN_ID="{{ chain_id_everclear_staging }}" && \
    export POLYMER_ISM_FOR_REMOTE_ORIGIN_ADDRESS="{{ polymer_ism_addr_base }}" && \
    forge script script/DeployDefaultFallbackRoutingIsm.s.sol:DeployDefaultFallbackRoutingIsm \
        --rpc-url "{{ rpc_endpoint_base }}" \
        --broadcast \
        -vvvv

deploy-domain-routing-mailbox-everclear-staging:
    export DEFAULT_MAILBOX_ADDRESS="{{ default_mailbox_contract_addr_everclear_staging }}" && \
    forge script script/DeployDomainRoutingMailbox.s.sol:DeployDomainRoutingMailbox \
        --rpc-url "{{ rpc_endpoint_everclear_staging }}" \
        --broadcast \
        -vvvv

deploy-domain-routing-mailbox-base:
    export DEFAULT_MAILBOX_ADDRESS="{{ default_mailbox_contract_addr_base }}" && \
    forge script script/DeployDomainRoutingMailbox.s.sol:DeployDomainRoutingMailbox \
        --rpc-url "{{ rpc_endpoint_base }}" \
        --broadcast \
        -vvvv

configure-domain-routing-mailbox-everclear-staging:
    export DOMAIN_ROUTING_MAILBOX_ADDRESS="{{ domain_routing_mailbox_addr_everclear_staging }}" && \
    export DOMAIN_ID="{{ chain_id_base }}" && \
    export DOMAIN_MAILBOX_ADDRESS="{{ mailbox_contract_addr_everclear_staging }}" && \
    forge script script/ConfigureDomainRoutingMailbox.s.sol:ConfigureDomainRoutingMailbox \
        --rpc-url "{{ rpc_endpoint_everclear_staging }}" \
        --broadcast \
        -vvvv

deploy-fallback-domain-routing-hook-everclear-staging:
    export LOCAL_MAILBOX_ADDRESS="{{ mailbox_contract_addr_everclear_staging }}" && \
    export DEFAULT_HOOK_ADDRESS="{{ protocol_fee_hook_addr_everclear_staging }}" && \
    forge script script/DeployFallbackDomainRoutingHook.s.sol:DeployFallbackDomainRoutingHook \
        --rpc-url "{{ rpc_endpoint_everclear_staging }}" \
        --broadcast \
        -vvvv

configure-fallback-domain-routing-hook-everclear-staging:
    export FALLBACK_DOMAIN_ROUTING_HOOK_ADDRESS="{{ fallback_domain_routing_hook_addr_everclear_staging }}" && \
    export DESTINATION_DOMAIN="{{ chain_id_base }}" && \
    export MOCK_HOOK_ADDRESS="{{ mock_hook_addr_everclear_staging }}" && \
    forge script script/ConfigureFallbackDomainRoutingHook.s.sol:ConfigureFallbackDomainRoutingHook \
        --rpc-url "{{ rpc_endpoint_everclear_staging }}" \
        --broadcast \
        -vvvv

configure-domain-routing-mailbox-base:
    export DOMAIN_ROUTING_MAILBOX_ADDRESS="{{ domain_routing_mailbox_addr_base }}" && \
    export DOMAIN_ID="{{ chain_id_everclear_staging }}" && \
    export DOMAIN_MAILBOX_ADDRESS="{{ mailbox_contract_addr_base }}" && \
    forge script script/ConfigureDomainRoutingMailbox.s.sol:ConfigureDomainRoutingMailbox \
        --rpc-url "{{ rpc_endpoint_base }}" \
        --broadcast \
        -vvvv

deploy-domain-routing-hook-everclear-staging:
    export LOCAL_MAILBOX_ADDRESS="{{ mailbox_contract_addr_everclear_staging }}" && \
    forge script script/DeployDomainRoutingHook.s.sol:DeployDomainRoutingHook \
        --rpc-url "{{ rpc_endpoint_everclear_staging }}" \
        --broadcast \
        -vvvv

deploy-simple-app-b3:
    export MAILBOX_ADDRESS="{{ mailbox_contract_addr_b3 }}" && \
    export ISM_ADDRESS="{{ default_fallback_routing_ism_addr_b3 }}" && \
    forge script script/DeploySimpleMessageSenderReceiver.s.sol:DeploySimpleMessageSenderReceiver \
        --rpc-url "{{ rpc_endpoint_b3 }}" \
        --broadcast \
        -vvvv

deploy-simple-app-ape:
    export MAILBOX_ADDRESS="{{ mailbox_contract_addr_ape }}" && \
    export ISM_ADDRESS="{{ default_fallback_routing_ism_addr_ape }}" && \
    forge script script/DeploySimpleMessageSenderReceiver.s.sol:DeploySimpleMessageSenderReceiver \
        --rpc-url "{{ rpc_endpoint_ape }}" \
        --broadcast \
        -vvvv

deploy-simple-app-base:
    export MAILBOX_ADDRESS="{{ mailbox_contract_addr_base }}" && \
    export ISM_ADDRESS="{{ polymer_ism_addr_base }}" && \
    forge script script/DeploySimpleMessageSenderReceiver.s.sol:DeploySimpleMessageSenderReceiver \
        --rpc-url "{{ rpc_endpoint_base }}" \
        --broadcast \
        -vvvv

deploy-simple-app-everclear-staging:
    export MAILBOX_ADDRESS="{{ domain_routing_mailbox_addr_everclear_staging }}" && \
    export ISM_ADDRESS="{{ polymer_ism_addr_everclear_staging }}" && \
    forge script script/DeploySimpleMessageSenderReceiver.s.sol:DeploySimpleMessageSenderReceiver \
        --rpc-url "{{ rpc_endpoint_everclear_staging }}" \
        --broadcast \
        -vvvv

send-message-b3-to-ape:
    export SENDER_CONTRACT_ADDRESS="{{ simple_sender_receiver_addr_b3 }}" && \
    export DESTINATION_DOMAIN="{{ chain_id_ape }}" && \
    export RECIPIENT_CONTRACT_ADDRESS="{{ simple_sender_receiver_addr_ape }}" && \
    export MESSAGE_CONTENT="Hello from B3 to Ape!" && \
    forge script script/SendMessage.s.sol:SendMessage \
        --rpc-url "{{ rpc_endpoint_b3 }}" \
        --broadcast \
        -vvvv

send-message-ape-to-b3:
    export SENDER_CONTRACT_ADDRESS="{{ simple_sender_receiver_addr_ape }}" && \
    export DESTINATION_DOMAIN="{{ chain_id_b3 }}" && \
    export RECIPIENT_CONTRACT_ADDRESS="{{ simple_sender_receiver_addr_b3 }}" && \
    export MESSAGE_CONTENT="Hello from Ape Curtis to B3 Sepolia!" && \
    forge script script/SendMessage.s.sol:SendMessage \
        --rpc-url "{{ rpc_endpoint_ape }}" \
        --broadcast \
        -vvvv

send-message-base-to-everclear-staging:
    export SENDER_CONTRACT_ADDRESS="{{ simple_sender_receiver_addr_base }}" && \
    export DESTINATION_DOMAIN="{{ chain_id_everclear_staging }}" && \
    export RECIPIENT_CONTRACT_ADDRESS="{{ simple_sender_receiver_addr_everclear_staging }}" && \
    export MESSAGE_CONTENT="Hello from Base to Everclear Staging!" && \
    forge script script/SendMessage.s.sol:SendMessage \
        --rpc-url "{{ rpc_endpoint_base }}" \
        --broadcast \
        -vvvv

send-message-everclear-staging-to-base:
    export SENDER_CONTRACT_ADDRESS="{{ simple_sender_receiver_addr_everclear_staging }}" && \
    export DESTINATION_DOMAIN="{{ chain_id_base }}" && \
    export RECIPIENT_CONTRACT_ADDRESS="{{ simple_sender_receiver_addr_base }}" && \
    export MESSAGE_CONTENT="Hello from Everclear Staging to Base!" && \
    forge script script/SendMessage.s.sol:SendMessage \
        --rpc-url "{{ rpc_endpoint_everclear_staging }}" \
        --broadcast \
        -vvvv

test-mailbox-contract-deployment-b3:
    cast call "{{ mailbox_contract_addr_b3 }}" "requiredHook()" --rpc-url "{{ rpc_endpoint_b3 }}"
    cast call "{{ mailbox_contract_addr_b3 }}" "nonce()" --rpc-url "{{ rpc_endpoint_b3 }}"

test-mailbox-contract-deployment-ape:
    cast call "{{ mailbox_contract_addr_ape }}" "requiredHook()" --rpc-url "{{ rpc_endpoint_ape }}"
    cast call "{{ mailbox_contract_addr_ape }}" "nonce()" --rpc-url "{{ rpc_endpoint_ape }}"

test-mailbox-contract-deployment-everclear-staging:
    cast call "{{ default_mailbox_contract_addr_everclear_staging }}" "requiredHook()" --rpc-url "{{ rpc_endpoint_everclear_staging }}"

configure-mailbox-required-hook-everclear-staging:
    export MAILBOX_ADDRESS="{{ mailbox_contract_addr_everclear_staging }}" && \
    export REQUIRED_HOOK_ADDRESS="{{ fallback_domain_receipt_routing_hook_addr_everclear_staging }}" && \
    forge script script/ConfigureMailbox.s.sol:ConfigureMailbox \
        --rpc-url "{{ rpc_endpoint_everclear_staging }}" \
        --broadcast \
        -vvvv

display-origin-mailbox-polymer-ism-everclear-staging:
    cast call "{{ polymer_ism_addr_everclear_staging }}" "originMailbox()" --rpc-url "{{ rpc_endpoint_everclear_staging }}"

debug-msg-sending-base-everclear-staging:
    forge test --match-path script/DebugSendingV2.sol --match-test test_do_fork -vvvv

deploy-mock-hook-everclear-staging:
    forge script script/DeployMockHook.s.sol:DeployMockHook \
        --rpc-url "{{ rpc_endpoint_everclear_staging }}" \
        --broadcast \
        -vvvv

deploy-fallback-domain-recipient-hook-everclear-staging:
    export LOCAL_MAILBOX_ADDRESS="{{ mailbox_contract_addr_everclear_staging }}" && \
    export FALLBACK_HOOK_ADDRESS="{{ protocol_fee_hook_addr_everclear_staging }}" && \
    forge script script/DeployFallbackDomainRecipientRoutingHook.s.sol:DeployFallbackDomainRecipientRoutingHook \
        --rpc-url "{{ rpc_endpoint_everclear_staging }}" \
        --broadcast \
        -vvvv

configure-fallback-domain-recipient-hook-everclear-staging:
    export HOOK_ADDRESS="{{ fallback_domain_receipt_routing_hook_addr_everclear_staging }}" && \
    export DESTINATION_DOMAIN="{{ chain_id_base }}" && \
    export RECIPIENT_ADDRESS="{{ simple_sender_receiver_addr_base }}" && \
    export TARGET_HOOK_ADDRESS="{{ mock_hook_addr_everclear_staging }}" && \
    forge script script/ConfigureFallbackDomainRecipientRoutingHook.s.sol:ConfigureFallbackDomainRecipientRoutingHook \
        --rpc-url "{{ rpc_endpoint_everclear_staging }}" \
        --broadcast \
        -vvvv
